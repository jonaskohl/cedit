function CEdit(t){if(!(t instanceof HTMLTextAreaElement))throw new TypeError("Parameter has to be of type HTMLTextAreaElement (but was "+t.constructor.name+")");function e(e,n){var i=-1;null===n&&e.indexOf("|")>=0&&(i=e.indexOf("|"),e=e.replace(/\|/g,""));var o=Math.min(t.selectionStart,t.selectionEnd),l=Math.max(t.selectionStart,t.selectionEnd);t.value=t.value.substring(0,o)+e+t.value.substring(o,l)+(n||"")+t.value.substring(l,t.value.length),i>=0?t.selectionStart=t.selectionEnd=o+i:(t.selectionStart=o+e.length,t.selectionEnd=l+e.length)}function n(e,n){var i=Math.min(t.selectionStart,t.selectionEnd),o=Math.max(t.selectionStart,t.selectionEnd);return t.value.substr(i-e.length,e.length)===e&&t.value.substr(o,n.length)===n}function i(i,o){n(i,o)?function(e,n){if(null===n)throw new TypeError("Second parameter cannot be null");var i=Math.min(t.selectionStart,t.selectionEnd),o=Math.max(t.selectionStart,t.selectionEnd);t.value=t.value.substring(0,i-e.length)+t.value.substring(i,o)+t.value.substring(o+n.length,t.value.length),t.selectionStart=i-e.length,t.selectionEnd=o-e.length}(i,o):e(i,o)}function o(t,e,n,i,o,l){!0!==l&&(l=!1);var r=null;if(null!==e){var a=e.toLowerCase().split("-"),c=a.indexOf("ctrl")>=0,s=a.indexOf("alt")>=0,u=a.indexOf("shift")>=0;r={key:a[a.length-1],ctrl:c,shift:u,alt:s}}m[t]={displayname:o,type:"insert",insertonly:l,keys:r,insert:{before:n,after:i}}}function l(t,e,n,i){var o=null;if(null!==e){var l=e.toLowerCase().split("-"),r=l.indexOf("ctrl")>=0,a=l.indexOf("alt")>=0,c=l.indexOf("shift")>=0;o={key:l[l.length-1],ctrl:r,shift:c,alt:a}}m[t]={displayname:n,type:"callback",keys:o,callback:i}}function r(t){"insert"===t.type?t.insertonly?e(t.insert.before,t.insert.after):i(t.insert.before,t.insert.after):"callback"===t.type&&t.callback()}function a(e,n,i){var o=document.createElement("button");o.type="button",o.title=i;var l="";return 1===y.tbgroup?l=" cedit-toolbar-button-group-begin":2===y.tbgroup?l=" cedit-toolbar-button-group-inside":3===y.tbgroup&&(l=" cedit-toolbar-button-group-end"),o.className="cedit-toolbar-button"+l,o.addEventListener("click",(function(){try{r(m[n])}catch(t){console.error(t),alert(t)}t.focus()})),o.innerText=e,x.appendChild(o),g.push({text:e,command:n,tooltip:i,DOMelement:o}),1===y.tbgroup?y.tbgroup=2:3===y.tbgroup&&(y.tbgroup=0),o}function c(){var t=document.createElement("div");t.className="cedit-toolbar-separator",x.appendChild(t)}function s(){y.tbgroup=1}function u(){y.tbgroup=3}function d(){document.activeElement===t&&Object.keys(m).map((function(t){return[t,m[t]]})).forEach((function(t){var e=t[0],i=t[1];if("insert"===i.type){var o=!1;!i.insertonly&&null!==i.insert.after&&n(i.insert.before,i.insert.after)&&(o=!0);var l=g.filter((function(t){return t.command==e}));if(!(l.length<1))l[0].DOMelement.classList.toggle("cedit-toolbar-button-highlighted",o)}}))}function b(t,e){for(var n="";e>0;)n+=t,e--;return n}function f(t){return t.charAt(0).toUpperCase()+t.slice(1)}function h(t){Object.keys(g).map((function(t){return g[t].DOMelement})).forEach((function(e){t?e.removeAttribute("disabled"):e.setAttribute("disabled","disabled")}))}function p(e){e?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")}var m={},g=[],v=document.createElement("div"),x=document.createElement("div"),y={tbgroup:0};v.className="cedit-root",x.className="cedit-toolbar",t.classList.add("cedit-textarea"),t.parentElement.insertBefore(v,t),v.appendChild(x),v.appendChild(t),t.addEventListener("keydown",(function(t){Object.keys(m).map((function(t){return m[t]})).forEach((function(e){null!==m.keys&&t.key.toLowerCase()===e.keys.key.toLowerCase()&&t.ctrlKey===e.keys.ctrl&&t.altKey===e.keys.alt&&t.shiftKey===e.keys.shift&&(t.preventDefault(),r(e))})),d()})),document.addEventListener("selectionchange",d),t.addEventListener("mousedown",d),t.addEventListener("mouseup",d),t.addEventListener("keyup",d),this.textarea=t,this.gtokens=()=>m,o("builtin/font/bold","ctrl-b","*","*","Toggle bold text"),o("builtin/font/italic","ctrl-i","/","/","Toggle italic text"),o("builtin/font/underline","ctrl-u","_","_","Toggle underlined text"),o("builtin/font/color","ctrl-shift-c","{color:#000000 ","}","Change text color"),o("builtin/font/monospace","ctrl-r","`","`","Toggle monospaced text"),o("builtin/text/link","ctrl-l","{link:url ","}","Insert hyperlink"),o("builtin/text/mention","ctrl-m","{user:|}",null,"Mention user",!0);for(var E=1;E<=6;E++)o("builtin/text/header"+E,"ctrl-shift-"+"asdfgh".split("")[E-1],b("#",E)+" ","","Header "+E,!0);l("builtin/action/submit","ctrl-enter","Submit form",(function(){for(var e=t;!(e instanceof HTMLFormElement);)if((e=e.parentElement)===document.documentElement)return;e.checkValidity()?e.submit():alert("Form is not valid, please check input")})),l("builtin/action/help","ctrl-shift-j","Show keyboard shortcuts",(function(){var e=[];Object.keys(m).map((function(t){return[t,m[t]]})).forEach((function(t){var n;e.push([t[1].displayname,(n=t[1].keys,[n.ctrl?"Ctrl":null,n.alt?"Alt":null,n.shift?"Shift":null,f(n.key)].filter(Boolean).join("-"))])}));var n,i,o,l,r,a=Math.max.apply(null,e.map((function(t){return t[0].length})))+2,c="";e.forEach((function(t){c+=function(t,e,n){return n||(n=" "),(t+b(n,e)).substring(0,e)}(t[0]+" ",a,".")+" "+t[1]+"\n"})),n=c,i=document.createElement("div"),o=document.createElement("div"),l=document.createElement("div"),r=document.createElement("button"),i.className="cedit-alert-root",o.className="cedit-alert-message",l.className="cedit-alert-buttons",r.className="cedit-alert-button",r.innerText="Dismiss",r.addEventListener("click",(function(){h(!0),p(!0),v.removeChild(i),t.focus()})),o.innerText=n,l.appendChild(r),i.appendChild(o),i.appendChild(l),v.appendChild(i),r.focus(),h(!1),p(!1)})),l("builtin/toolbar/expandcollapse","ctrl-shift-alt-t","Expand/collapse toolbar",(function(){x.classList.toggle("cedit-toolbar-collapsed")})),l("builtin/action/selectcurrent","ctrl- ","Select current token",(function(){var e=Math.min(t.selectionStart,t.selectionEnd),n=Math.max(t.selectionStart,t.selectionEnd);t.selectionStart=e,t.selectionEnd=n;for(var i=Object.values(m).filter((function(t){return"insert"===t.type})).map((function(t){return t.insert})),o=null,l=!0;e>0&&l;){for(var r of i)if(t.value.substr(e-r.before.length,r.before.length)===r.before){o=r.after,l=!1;break}l&&e--}if(null!==o){for(var a=!1;n<t.value.length-1;){if(t.value.substr(n,o.length)===o){a=!0;break}n++}a&&(t.selectionStart=e,t.selectionEnd=n)}})),s(),a("B","builtin/font/bold","Toggle bold text").classList.add("cedit-toolbar-button_font-bold","cedit-toolbar-button-fixed-width"),a("I","builtin/font/italic","Toggle italic text").classList.add("cedit-toolbar-button_font-italic","cedit-toolbar-button-fixed-width"),a("U","builtin/font/underline","Toggle underlined text").classList.add("cedit-toolbar-button_font-underline","cedit-toolbar-button-fixed-width"),u(),a("</>","builtin/font/monospace","Toggle monospaced text").classList.add("cedit-toolbar-button_font-monospace","cedit-toolbar-button-fixed-width"),c(),s(),a("ðŸ”—ï¸Ž","builtin/text/link","Insert hyperlink").classList.add("cedit-toolbar-button_text-link","cedit-toolbar-button-fixed-width"),u(),a("ðŸŽ¨ï¸Ž","builtin/font/color","Change text color").classList.add("cedit-toolbar-button_font-color","cedit-toolbar-button-fixed-width"),c(),a("@","builtin/text/mention","Mention user").classList.add("cedit-toolbar-button_text-mention","cedit-toolbar-button-fixed-width"),c(),a("?","builtin/action/help","Show keyboard shortcuts").classList.add("cedit-toolbar-button_action-help","cedit-toolbar-button-fixed-width"),c(),a("","builtin/toolbar/expandcollapse","Expand/collapse toolbar").classList.add("cedit-toolbar-button_expand-collapse","cedit-toolbar-button-fixed-width")}
//# sourceMappingURL=cedit.min.js.map