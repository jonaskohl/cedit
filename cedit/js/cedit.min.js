function CEdit(t){if(!(t instanceof HTMLTextAreaElement))throw new TypeError("Parameter has to be of type HTMLTextAreaElement (but was "+t.constructor.name+")");function e(e,n){var i=-1;null===n&&e.indexOf("|")>=0&&(i=e.indexOf("|"),e=e.replace(/\|/g,""));var l=Math.min(t.selectionStart,t.selectionEnd),o=Math.max(t.selectionStart,t.selectionEnd);t.value=t.value.substring(0,l)+e+t.value.substring(l,o)+(n||"")+t.value.substring(o,t.value.length),i>=0?t.selectionStart=t.selectionEnd=l+i:(t.selectionStart=l+e.length,t.selectionEnd=o+e.length)}function n(e,n){var i=Math.min(t.selectionStart,t.selectionEnd),l=Math.max(t.selectionStart,t.selectionEnd);return t.value.substr(i-e.length,e.length)===e&&t.value.substr(l,n.length)===n}function i(i,l){n(i,l)?function(e,n){if(null===n)throw new TypeError("Second parameter cannot be null");var i=Math.min(t.selectionStart,t.selectionEnd),l=Math.max(t.selectionStart,t.selectionEnd);t.value=t.value.substring(0,i-e.length)+t.value.substring(i,l)+t.value.substring(l+n.length,t.value.length),t.selectionStart=i-e.length,t.selectionEnd=l-e.length}(i,l):e(i,l)}function l(t,e,n,i,l,o){!0!==o&&(o=!1);var a=null;if(null!==e){var r=e.toLowerCase().split("-"),c=r.indexOf("ctrl")>=0,s=r.indexOf("alt")>=0,u=r.indexOf("shift")>=0;a={key:r[r.length-1],ctrl:c,shift:u,alt:s}}m[t]={displayname:l,type:"insert",insertonly:o,keys:a,insert:{before:n,after:i}}}function o(t,e,n,i){var l=null;if(null!==e){var o=e.toLowerCase().split("-"),a=o.indexOf("ctrl")>=0,r=o.indexOf("alt")>=0,c=o.indexOf("shift")>=0;l={key:o[o.length-1],ctrl:a,shift:c,alt:r}}m[t]={displayname:n,type:"callback",keys:l,callback:i}}function a(t){"insert"===t.type?t.insertonly?e(t.insert.before,t.insert.after):i(t.insert.before,t.insert.after):"callback"===t.type&&t.callback()}function r(e,n,i){var l=document.createElement("button");l.type="button",l.title=i;var o="";return 1===E.tbgroup?o=" cedit-toolbar-button-group-begin":2===E.tbgroup?o=" cedit-toolbar-button-group-inside":3===E.tbgroup&&(o=" cedit-toolbar-button-group-end"),l.className="cedit-toolbar-button"+o,l.addEventListener("click",(function(){try{a(m[n])}catch(t){console.error(t),alert(t)}t.focus()})),l.innerText=e,x.appendChild(l),g.push({text:e,command:n,tooltip:i,DOMelement:l}),1===E.tbgroup?E.tbgroup=2:3===E.tbgroup&&(E.tbgroup=0),l}function c(){var t=document.createElement("div");t.className="cedit-toolbar-separator",x.appendChild(t)}function s(){E.tbgroup=1}function u(){E.tbgroup=3}function d(){document.activeElement===t&&Object.keys(m).map((function(t){return[t,m[t]]})).forEach((function(t){var e=t[0],i=t[1];if("insert"===i.type){var l=!1;!i.insertonly&&null!==i.insert.after&&n(i.insert.before,i.insert.after)&&(l=!0);var o=g.filter((function(t){return t.command==e}));if(!(o.length<1))o[0].DOMelement.classList.toggle("cedit-toolbar-button-highlighted",l)}}))}function b(t,e){for(var n="";e>0;)n+=t,e--;return n}function f(t){return t.charAt(0).toUpperCase()+t.slice(1)}function h(t){Object.keys(g).map((function(t){return g[t].DOMelement})).forEach((function(e){t?e.removeAttribute("disabled"):e.setAttribute("disabled","disabled")}))}function p(e){e?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")}console.log("%cCEdit Version "+[0,3,0].join("."),"font-size:2em;font-weight:bold");var m={},g=[],v=document.createElement("div"),x=document.createElement("div"),E={tbgroup:0};v.className="cedit-root",x.className="cedit-toolbar",t.classList.add("cedit-textarea"),t.parentElement.insertBefore(v,t),v.appendChild(x),v.appendChild(t),t.addEventListener("keydown",(function(t){Object.keys(m).map((function(t){return m[t]})).forEach((function(e){null!==m.keys&&t.key.toLowerCase()===e.keys.key.toLowerCase()&&t.ctrlKey===e.keys.ctrl&&t.altKey===e.keys.alt&&t.shiftKey===e.keys.shift&&(t.preventDefault(),a(e))})),d()})),document.addEventListener("selectionchange",d),t.addEventListener("mousedown",d),t.addEventListener("mouseup",d),t.addEventListener("keyup",d),this.textarea=t,this.gtokens=()=>m,l("builtin/font/bold","ctrl-b","*","*","Toggle bold text"),l("builtin/font/italic","ctrl-i","/","/","Toggle italic text"),l("builtin/font/underline","ctrl-u","_","_","Toggle underlined text"),l("builtin/font/color","ctrl-shift-c","{color:#000000 ","}","Change text color"),l("builtin/font/monospace","ctrl-r","`","`","Toggle monospaced text"),l("builtin/text/link","ctrl-l","{link:url ","}","Insert hyperlink"),l("builtin/text/mention","ctrl-m","{user:|}",null,"Mention user",!0),l("builtin/text/image","ctrl-shift-k","{image:| alttext}",null,"Insert image",!0),o("builtin/text/uppercase","ctrl-shift-arrowup","Uppercase",(function(){var e=t.value.substring(t.selectionStart,t.selectionEnd),n=e.toUpperCase(),i=n.length-e.length,l=t.selectionStart,o=t.selectionEnd;t.value=t.value.substring(0,l)+n+t.value.substring(o),t.selectionStart=l,t.selectionEnd=o+i})),o("builtin/text/lowercase","ctrl-shift-arrowdown","Lowercase",(function(){var e=t.value.substring(t.selectionStart,t.selectionEnd),n=e.toLowerCase(),i=n.length-e.length,l=t.selectionStart,o=t.selectionEnd;t.value=t.value.substring(0,l)+n+t.value.substring(o),t.selectionStart=l,t.selectionEnd=o+i}));for(var y=1;y<=6;y++)l("builtin/text/header"+y,"ctrl-shift-"+"asdfgh".split("")[y-1],b("#",y)+" ","","Header "+y,!0);o("builtin/action/submit","ctrl-enter","Submit form",(function(){for(var e=t;!(e instanceof HTMLFormElement);)if((e=e.parentElement)===document.documentElement)return;e.checkValidity()?e.submit():alert("Form is not valid, please check input")})),o("builtin/action/help","ctrl-shift-j","Show keyboard shortcuts",(function(){var e=[];Object.keys(m).map((function(t){return[t,m[t]]})).forEach((function(t){var n;e.push([t[1].displayname,(n=t[1].keys,[n.ctrl?"Ctrl":null,n.alt?"Alt":null,n.shift?"Shift":null," "===n.key?"Space":f(n.key)].filter(Boolean).join("-"))])}));var n,i,l,o,a,r=Math.max.apply(null,e.map((function(t){return t[0].length})))+2,c="";e.forEach((function(t){c+=function(t,e,n){return n||(n=" "),(t+b(n,e)).substring(0,e)}(t[0]+" ",r,".")+" "+t[1]+"\n"})),n=c,i=document.createElement("div"),l=document.createElement("div"),o=document.createElement("div"),a=document.createElement("button"),i.className="cedit-alert-root",l.className="cedit-alert-message",o.className="cedit-alert-buttons",a.className="cedit-alert-button",a.innerText="Dismiss",a.addEventListener("click",(function(){h(!0),p(!0),v.removeChild(i),t.focus()})),l.innerText=n,o.appendChild(a),i.appendChild(l),i.appendChild(o),v.appendChild(i),a.focus(),h(!1),p(!1)})),o("builtin/toolbar/expandcollapse","ctrl-shift-alt-t","Expand/collapse toolbar",(function(){x.classList.toggle("cedit-toolbar-collapsed")})),o("builtin/action/selectcurrent","ctrl- ","Select current token",(function(){var e=Math.min(t.selectionStart,t.selectionEnd),n=Math.max(t.selectionStart,t.selectionEnd);t.selectionStart=e,t.selectionEnd=n;for(var i=Object.values(m).filter((function(t){return"insert"===t.type})).map((function(t){return t.insert})),l=null,o=!0;e>=0&&o;){for(var a of i)if(t.value.substr(e-a.before.length,a.before.length)===a.before){l=a.after,o=!1;break}o&&e--}if(null!==l){for(var r=!1;n<t.value.length;){if(t.value.substr(n,l.length)===l){r=!0;break}n++}r&&(t.selectionStart=e,t.selectionEnd=n)}})),s(),r("B","builtin/font/bold","Toggle bold text").classList.add("cedit-toolbar-button_font-bold","cedit-toolbar-button-fixed-width"),r("I","builtin/font/italic","Toggle italic text").classList.add("cedit-toolbar-button_font-italic","cedit-toolbar-button-fixed-width"),r("U","builtin/font/underline","Toggle underlined text").classList.add("cedit-toolbar-button_font-underline","cedit-toolbar-button-fixed-width"),u(),r("</>","builtin/font/monospace","Toggle monospaced text").classList.add("cedit-toolbar-button_font-monospace","cedit-toolbar-button-fixed-width"),c(),s(),r("ðŸ”—ï¸Ž","builtin/text/link","Insert hyperlink").classList.add("cedit-toolbar-button_text-link","cedit-toolbar-button-fixed-width"),r("ðŸŽ¨ï¸Ž","builtin/font/color","Change text color").classList.add("cedit-toolbar-button_font-color","cedit-toolbar-button-fixed-width"),u(),r("ðŸ–¼ï¸Ž","builtin/text/image","Insert image").classList.add("cedit-toolbar-button_text-image","cedit-toolbar-button-fixed-width"),c(),r("@","builtin/text/mention","Mention user").classList.add("cedit-toolbar-button_text-mention","cedit-toolbar-button-fixed-width"),c(),r("?","builtin/action/help","Show keyboard shortcuts").classList.add("cedit-toolbar-button_action-help","cedit-toolbar-button-fixed-width"),c(),r("","builtin/toolbar/expandcollapse","Expand/collapse toolbar").classList.add("cedit-toolbar-button_expand-collapse","cedit-toolbar-button-fixed-width")}
//# sourceMappingURL=cedit.min.js.map